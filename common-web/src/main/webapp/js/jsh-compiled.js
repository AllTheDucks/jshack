var k=void 0,l=!0,n=null,r=!1,t,u=this;
function v(a){var b=typeof a;if("object"==b)if(a){if(a instanceof Array)return"array";if(a instanceof Object)return b;var d=Object.prototype.toString.call(a);if("[object Window]"==d)return"object";if("[object Array]"==d||"number"==typeof a.length&&"undefined"!=typeof a.splice&&"undefined"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("splice"))return"array";if("[object Function]"==d||"undefined"!=typeof a.call&&"undefined"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("call"))return"function"}else return"null";
else if("function"==b&&"undefined"==typeof a.call)return"object";return b}var w="closure_uid_"+Math.floor(2147483648*Math.random()).toString(36),x=0;var y=Array.prototype,aa=y.indexOf?function(a,b,d){return y.indexOf.call(a,b,d)}:function(a,b,d){d=d==n?0:0>d?Math.max(0,a.length+d):d;if("string"==typeof a)return"string"!=typeof b||1!=b.length?-1:a.indexOf(b,d);for(;d<a.length;d++)if(d in a&&a[d]===b)return d;return-1};var A,B,C,D,ba;function ca(){return u.navigator?u.navigator.userAgent:n}function E(){return u.navigator}D=C=B=A=r;var F;if(F=ca()){var da=E();A=0==F.indexOf("Opera");B=!A&&-1!=F.indexOf("MSIE");(C=!A&&-1!=F.indexOf("WebKit"))&&F.indexOf("Mobile");D=!A&&!C&&"Gecko"==da.product}var ea=A,G=B,H=D,I=C,J,fa=E();J=fa&&fa.platform||"";ba=-1!=J.indexOf("Mac");J.indexOf("Win");J.indexOf("Linux");E()&&(E().appVersion||"").indexOf("X11");var K;
a:{var L="",M;if(ea&&u.opera)var ga=u.opera.version,L="function"==typeof ga?ga():ga;else if(H?M=/rv\:([^\);]+)(\)|;)/:G?M=/MSIE\s+([^\);]+)(\)|;)/:I&&(M=/WebKit\/(\S+)/),M)var ha=M.exec(ca()),L=ha?ha[1]:"";if(G){var ia,ja=u.document;ia=ja?ja.documentMode:k;if(ia>parseFloat(L)){K=String(ia);break a}}K=L}var ka={};
function N(a){var b;if(!(b=ka[a])){b=0;for(var d=String(K).replace(/^[\s\xa0]+|[\s\xa0]+$/g,"").split("."),c=String(a).replace(/^[\s\xa0]+|[\s\xa0]+$/g,"").split("."),f=Math.max(d.length,c.length),e=0;0==b&&e<f;e++){var g=d[e]||"",h=c[e]||"",m=RegExp("(\\d*)(\\D*)","g"),p=RegExp("(\\d*)(\\D*)","g");do{var s=m.exec(g)||["","",""],q=p.exec(h)||["","",""];if(0==s[0].length&&0==q[0].length)break;b=((0==s[1].length?0:parseInt(s[1],10))<(0==q[1].length?0:parseInt(q[1],10))?-1:(0==s[1].length?0:parseInt(s[1],
10))>(0==q[1].length?0:parseInt(q[1],10))?1:0)||((0==s[2].length)<(0==q[2].length)?-1:(0==s[2].length)>(0==q[2].length)?1:0)||(s[2]<q[2]?-1:s[2]>q[2]?1:0)}while(0==b)}b=ka[a]=0<=b}return b}var la={};function O(){return la[9]||(la[9]=G&&!!document.documentMode&&9<=document.documentMode)};var ma;!G||O();!H&&!G||G&&O()||H&&N("1.9.1");G&&N("9");function P(a){return"string"==typeof a?document.getElementById(a):a}function na(a){this.U=a||u.document||document}na.prototype.createElement=function(a){return this.U.createElement(a)};var oa={};function pa(a){this.name=a?a.name:n;this.description=a?a.description:n;this.identifier=a?a.identifier:n;this.version=a?a.version:n;this.v=a?a.v:n;this.u=a?a.u:n;this.n=a?a.n:n;this.m=a?a.m:n;this.e=a?a.e:n;this.d=a?a.d:n;this.g=a?a.g:[];this.l=a?a.l:[];this.ea={};if(a)for(var a=a.g,b=0;a&&b<a.length;b++)this.ea[a[b].path]=a[b]};function qa(){};!G||O();var ra=!G||O(),sa=G&&!N("9");!I||N("528");H&&N("1.9b")||G&&N("8")||ea&&N("9.5")||I&&N("528");H&&!N("8")||G&&N("9");function Q(a,b){this.type=a;this.currentTarget=this.target=b}Q.prototype.r=r;Q.prototype.defaultPrevented=r;Q.prototype.ha=l;Q.prototype.preventDefault=function(){this.defaultPrevented=l;this.ha=r};function ta(a){ta[" "](a);return a}ta[" "]=function(){};function R(a,b){a&&this.init(a,b)}function ua(){}ua.prototype=Q.prototype;R.ia=Q.prototype;R.prototype=new ua;t=R.prototype;t.target=n;t.relatedTarget=n;t.offsetX=0;t.offsetY=0;t.clientX=0;t.clientY=0;t.screenX=0;t.screenY=0;t.button=0;t.keyCode=0;t.charCode=0;t.ctrlKey=r;t.altKey=r;t.shiftKey=r;t.metaKey=r;t.ca=r;t.z=n;
t.init=function(a,b){var d=this.type=a.type;Q.call(this,d);this.target=a.target||a.srcElement;this.currentTarget=b;var c=a.relatedTarget;if(c){if(H){var f;a:{try{ta(c.nodeName);f=l;break a}catch(e){}f=r}f||(c=n)}}else"mouseover"==d?c=a.fromElement:"mouseout"==d&&(c=a.toElement);this.relatedTarget=c;this.offsetX=I||a.offsetX!==k?a.offsetX:a.layerX;this.offsetY=I||a.offsetY!==k?a.offsetY:a.layerY;this.clientX=a.clientX!==k?a.clientX:a.pageX;this.clientY=a.clientY!==k?a.clientY:a.pageY;this.screenX=
a.screenX||0;this.screenY=a.screenY||0;this.button=a.button;this.keyCode=a.keyCode||0;this.charCode=a.charCode||("keypress"==d?a.keyCode:0);this.ctrlKey=a.ctrlKey;this.altKey=a.altKey;this.shiftKey=a.shiftKey;this.metaKey=a.metaKey;this.ca=ba?a.metaKey:a.ctrlKey;this.state=a.state;this.z=a;a.defaultPrevented&&this.preventDefault();delete this.r};
t.preventDefault=function(){R.ia.preventDefault.call(this);var a=this.z;if(a.preventDefault)a.preventDefault();else if(a.returnValue=r,sa)try{if(a.ctrlKey||112<=a.keyCode&&123>=a.keyCode)a.keyCode=-1}catch(b){}};function va(){}var wa=0;t=va.prototype;t.key=0;t.c=r;t.w=r;t.init=function(a,b,d,c,f,e){if("function"==v(a))this.F=l;else if(a&&a.handleEvent&&"function"==v(a.handleEvent))this.F=r;else throw Error("Invalid listener argument");this.j=a;this.H=b;this.src=d;this.type=c;this.capture=!!f;this.B=e;this.w=r;this.key=++wa;this.c=r};t.handleEvent=function(a){return this.F?this.j.call(this.B||this.src,a):this.j.handleEvent.call(this.j,a)};var T={},U={},V={},W={};
function X(a,b,d,c,f){if(b)if("array"==v(b))for(var e=0;e<b.length;e++)X(a,b[e],d,c,f);else{var c=!!c,g=U;b in g||(g[b]={a:0,b:0});g=g[b];c in g||(g[c]={a:0,b:0},g.a++);var g=g[c],h=a[w]||(a[w]=++x),m;g.b++;if(g[h]){m=g[h];for(e=0;e<m.length;e++)if(g=m[e],g.j==d&&g.B==f){if(g.c)break;return}}else m=g[h]=[],g.a++;var p=xa,s=ra?function(a){return p.call(s.src,s.key,a)}:function(a){a=p.call(s.src,s.key,a);if(!a)return a},e=s;e.src=a;g=new va;g.init(d,e,a,b,c,f);d=g.key;e.key=d;m.push(g);T[d]=g;V[h]||
(V[h]=[]);V[h].push(g);a.addEventListener?(a==u||!a.K)&&a.addEventListener(b,e,c):a.attachEvent(b in W?W[b]:W[b]="on"+b,e)}else throw Error("Invalid event type");}function ya(a,b,d,c){if(!c.k&&c.G){for(var f=0,e=0;f<c.length;f++)c[f].c?c[f].H.src=n:(f!=e&&(c[e]=c[f]),e++);c.length=e;c.G=r;0==e&&(delete U[a][b][d],U[a][b].a--,0==U[a][b].a&&(delete U[a][b],U[a].a--),0==U[a].a&&delete U[a])}}
function za(a,b,d,c,f){var e=1,b=b[w]||(b[w]=++x);if(a[b]){a.b--;a=a[b];a.k?a.k++:a.k=1;try{for(var g=a.length,h=0;h<g;h++){var m=a[h];m&&!m.c&&(e&=Aa(m,f)!==r)}}finally{a.k--,ya(d,c,b,a)}}return Boolean(e)}
function Aa(a,b){if(a.w){var d=a.key;if(T[d]){var c=T[d];if(!c.c){var f=c.src,e=c.type,g=c.H,h=c.capture;f.removeEventListener?(f==u||!f.K)&&f.removeEventListener(e,g,h):f.detachEvent&&f.detachEvent(e in W?W[e]:W[e]="on"+e,g);f=f[w]||(f[w]=++x);if(V[f]){var g=V[f],m=aa(g,c);0<=m&&y.splice.call(g,m,1);0==g.length&&delete V[f]}c.c=l;if(c=U[e][h][f])c.G=l,ya(e,h,f,c);delete T[d]}}}return a.handleEvent(b)}
function xa(a,b){if(!T[a])return l;var d=T[a],c=d.type,f=U;if(!(c in f))return l;var f=f[c],e,g;if(!ra){var h;if(!(h=b))a:{h=["window","event"];for(var m=u;e=h.shift();)if(m[e]!=n)m=m[e];else{h=n;break a}h=m}e=h;h=l in f;m=r in f;if(h){if(0>e.keyCode||e.returnValue!=k)return l;a:{var p=r;if(0==e.keyCode)try{e.keyCode=-1;break a}catch(s){p=l}if(p||e.returnValue==k)e.returnValue=l}}p=new R;p.init(e,this);e=l;try{if(h){for(var q=[],S=p.currentTarget;S;S=S.parentNode)q.push(S);g=f[l];g.b=g.a;for(var z=
q.length-1;!p.r&&0<=z&&g.b;z--)p.currentTarget=q[z],e&=za(g,q[z],c,l,p);if(m){g=f[r];g.b=g.a;for(z=0;!p.r&&z<q.length&&g.b;z++)p.currentTarget=q[z],e&=za(g,q[z],c,r,p)}}else e=Aa(d,p)}finally{q&&(q.length=0)}return e}c=new R(b,this);return e=Aa(d,c)};G&&N(8);function Y(a,b){var d=(ma||(ma=new na)).createElement("DIV");d.innerHTML=a(b||Ba,k,k);if(1==d.childNodes.length){var c=d.firstChild;if(1==c.nodeType)return c}return d}var Ba={};function Z(a){return"object"===typeof a&&a&&0===a.ma?a.content:String(a).replace(Ca,Da)}var Ea={"\x00":"&#0;",'"':"&quot;","&":"&amp;","'":"&#39;","<":"&lt;",">":"&gt;","\t":"&#9;","\n":"&#10;","\x0B":"&#11;","\f":"&#12;","\r":"&#13;"," ":"&#32;","-":"&#45;","/":"&#47;","=":"&#61;","`":"&#96;","\u0085":"&#133;","\u00a0":"&#160;","\u2028":"&#8232;","\u2029":"&#8233;"};function Da(a){return Ea[a]}var Ca=/[\x00\x22\x26\x27\x3c\x3e]/g;function Fa(a){return'<div class="jsh-resourceDiv"><table style="width:100%"><tr class="fileRow"><th><label>File:</label></th><td>'+Z(a.f.path)+'<input type="hidden" name="'+Z(a.f.path)+'"/><input type="hidden" name="tempFileName" value="'+Z(a.f.ja)+'"/></td></tr><tr class="mimeRow"><th><label>Mime Type:</label></th><td><input type="text" name="mime" value="'+Z(a.f.$)+'"></input></td></tr><tr title="Copy and paste this code into the snippet editor."><th>Example Ref:</th><td class="exampleRef"><b>&lt;['+
Z(a.f.path)+']&gt;</b></td></tr><tr><td colspan="2"><span style="float:right;"><a href="#" class="removeResourceLink"></a></span></td></tr></table></div>'}
function Ga(a){return'<div class="jsh-restrictionDiv"><table style="width:100%"><tr><td style="width:18em">Type:<select name="type"><option value="URL" '+(!a.qa?'checked="checked"':"")+'>URL</option><option value="ENTITLEMENT">Entitlement</option><option value="ADVANCED">Advanced Expression</option><option value="COURSE_ROLE">Course Role</option><option value="SYSTEM_ROLE">System Role</option><option value="PORTAL_ROLE">Institution Role</option><option value="COURSE_AVAILABILITY" selected="true">Course Availability</option><option value="REQUEST_PARAMETER">Request Parameter</option></select><select name="inverse"><option value="false" selected="true">is</option><option value="true">is not</option></select></td><td style="width:4em">Value:</td><td><input type="text" name="value" style="width:100%;" value="false"></td><td style="width:10em;text-align: right;"><a href="#" class="removeRestrictionLink">Remove Restriction</a></td></tr></table></div>'}
function Ha(a){return'<div class="jsh-tab '+(a.pa?"jsh-active-tab":"")+'"><a href="#">'+Z(a.ua.identifier)+"</a></div>"}function Ia(){return'<div class="jsh-tab jsh-new-tab"><a href="#">New...</a></div>'};function Ja(a,b,d){this.p=d;this.view=a;this.view.q=this;this.A=b;for(var a=this.view,b=d.g,c=0;b&&c<b.length;c++){var f=a,e=b[c],g=Y(Fa,{resource:e});g.f=e;f.da.insert({bottom:g})}d=d.l;for(b=0;b<d.length;b++)c=a,f=d[b],e=Y(Ha,{snippet:f,opt_active:0===b}),e.s=f,X(e,"click",c.o,r,c),c.I?c.I.insert({before:e}):c.t.insert({bottom:e});b=Y(Ia);X(b,"click",a.X,r,a);a.t.insert({bottom:b});a.I=b;d=d[0];a.h.setValue(d.source);a.h.clearSelection();a=d.i;d=document.getElementsByName("jsh-hooks");for(i=0;i<
d.length;i++){b=r;for(j=0;a&&j<a.length;j++)if(a[j]===d[i].value){b=l;break}d[i].checked=b}}
function $(){this.q=n;this.ba=P("hack.name");this.O=P("hack.description");this.D=P("hack.identifier");this.W=P("hack.version");this.aa=P("hack.targetVersionMin");this.Y=P("hack.targetVersionMax");this.R=P("hack.developerName");this.Q=P("hack.developerInstitution");this.e=P("hack.developerURL");this.d=P("hack.developerEmail");this.da=P("jsh-resources");this.sa=P("step3");this.va=P("step4");this.t=P("jsh-tabbar");this.ga=P("jsh-restrictions");this.l=this.g=n;X(P("top_saveHackButton"),"click",this.o,
r,this);X(P("bottom_saveHackButton"),"click",this.o,r,this);X(P("jsh_addRestrictionButton"),"click",this.T,r,this);this.h=ace.edit("snippetEditor");this.h.getSession().setMode("ace/mode/html");this.h.clearSelection()}$.prototype.X=function(a){a.preventDefault();var a=a.target.parentElement,b=P("jsh-newcm");b.style.top=a.offsetTop+a.offsetHeight+"px";b.style.left=a.offsetLeft+"px";b.style.display="block";return r};
$.prototype.o=function(){var a=this.q,b=a.p;b.identifier=a.view.D.value;b.name=a.view.ba.value;b.description=a.view.O.value;b.version=a.view.W.value;b.v=a.view.aa.value;b.u=a.view.Y.value;b.n=a.view.R.value;b.m=a.view.Q.value;b.e=a.view.e.value;b.d=a.view.d.value;var d=a.view,c,f=(c=d.t)||document;if(f.querySelectorAll&&f.querySelector)c=f.querySelectorAll(".jsh-active-tab");else if(f.getElementsByClassName)c=f.getElementsByClassName("jsh-active-tab");else{var e,g,f=document;c=c||f;if(c.querySelectorAll&&
c.querySelector)c=c.querySelectorAll(".jsh-active-tab");else if(c.getElementsByClassName){var h=c.getElementsByClassName("jsh-active-tab");c=h}else{h=c.getElementsByTagName("*");g={};for(f=e=0;c=h[f];f++){var m=c.className,p;if(p="function"==typeof m.split)m=m.split(/\s+/),p=0<=aa(m,"jsh-active-tab");p&&(g[e++]=c)}g.length=e;c=g}}if(1===c.length&&(c=c[0],c.s)){c.s.source=d.h.getValue();d=document.getElementsByName("jsh-hooks");f=[];for(i=0;i<d.length;i++)e=d[i],e.checked&&f.push(e.value);c.s.i=f}var s=
function(a){a.wa&&(this.view.D.disabled=l)}.bind(a),q=function(){alert("There was an error")}.bind(a),a={};a["hack.identifier"]=b.identifier;a["hack.name"]=b.name;a["hack.description"]=b.description;a["hack.version"]=b.version;a["hack.targetVersionMin"]=b.v;a["hack.targetVersionMax"]=b.u;a["hack.developerName"]=b.n;a["hack.developerInstitution"]=b.m;a["hack.developerURL"]=b.e;a["hack.developerEmail"]=b.d;if(c=b.g){f=c.length;for(d=0;d<f;d++)a["hack.resources["+d+"].path"]=c[d].path,a["hack.resources["+
d+"].tempFileName"]=c[d].ja,a["hack.resources["+d+"].mime"]=oa.ka.J.V(c[d].$)}if(b=b.l){c=b.length;for(d=0;d<c;d++)if(f=b[d],a["hack.snippetDefinitions["+d+"].source"]=oa.ka.J.V(f.source),a["hack.snippetDefinitions["+d+"].identifier"]=f.identifier,f.i)for(j=0;j<f.i.length;j++)a["hack.snippetDefinitions["+d+"].hooks["+j+"]"]=f.i[j]}new Ajax.la("CreateHack.action?saveHackPackage",{method:"post",ra:a,oa:function(a){s(a.fa)},na:function(a){q(a.fa)}})};
$.prototype.T=function(){var a=Y(Ga,{opt_restriction:k});a.ta=k;this.ga.insert({bottom:a})};window.hackEditor=new function(a){this.p=new pa(a);this.A=new qa;this.view=new $;this.q=new Ja(this.view,this.A,this.p)}(window.hackModel,window.defaultSnippet);